/*
 ============================================================================
 Name        : Button.c
 Module Name : Button
 Author      : Ahmed Ali
 Date        : 22 Sept. 2024
 Description : Source file for Button Module
 ============================================================================
 */

#include "Button.h"
#include "tm4c123gh6pm_registers.h"

/* GPIO configuration and interrupt initialization for Port F (PF0, PF4) and Port B (PB0) */
void GPIO_SetupButtonsInterrupt(void)
{
    // Configure PF0 and PF4 as inputs
    GPIO_PORTF_DIR_R &= ~(PF0 | PF4);  // Set PF0 and PF4 as inputs
    GPIO_PORTF_DEN_R |= (PF0 | PF4);   // Digital enable PF0 and PF4

    // Enable falling edge trigger for PF0 and PF4
    GPIO_PORTF_IS_R &= ~(PF0 | PF4);   // Edge-sensitive
    GPIO_PORTF_IBE_R &= ~(PF0 | PF4);  // Not both edges
    GPIO_PORTF_IEV_R &= ~(PF0 | PF4);  // Falling edge
    GPIO_PORTF_ICR_R |= (PF0 | PF4);   // Clear any prior interrupts
    GPIO_PORTF_IM_R |= (PF0 | PF4);    // Unmask PF0 and PF4 interrupts

    // Set priority for Port F in NVIC
    NVIC_PRI7_R = (NVIC_PRI7_R & 0xFF00FFFF) | PRIORITY_2;  // Priority 2 for IRQ30
    NVIC_EN0_R |= NVIC_EN0_PORTF;  // Enable IRQ30 (Port F) in NVIC
}
